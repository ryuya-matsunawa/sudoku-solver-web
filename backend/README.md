# 数独自動解答バックエンド

このリポジトリは、数独（ナンプレ）を自動で解く FastAPI 製のバックエンドAPIです。

## 🔧 主な機能

- 9x9の数独パズルを解答
- CORS対応でフロントエンドと連携可能
- `/health` エンドポイントでの死活監視対応
- バックトラッキングアルゴリズムによる効率的な解法
- 無効なパズルの検出と適切なエラーレスポンス

## 📡 エンドポイント一覧

### `GET /health`

APIの稼働状態を確認するためのヘルスチェックエンドポイント。

**レスポンス例:**

```json
{
  "status": "ok"
}
```

### `POST /api/solve`

数独のパズルを解いて解答を返します。

**リクエストボディ例:**

```json
{
  "puzzle": [
    [5, 3, 0, 0, 7, 0, 0, 0, 0],
    [6, 0, 0, 1, 9, 5, 0, 0, 0],
    [0, 9, 8, 0, 0, 0, 0, 6, 0],
    [8, 0, 0, 0, 6, 0, 0, 0, 3],
    [4, 0, 0, 8, 0, 3, 0, 0, 1],
    [7, 0, 0, 0, 2, 0, 0, 0, 6],
    [0, 6, 0, 0, 0, 0, 2, 8, 0],
    [0, 0, 0, 4, 1, 9, 0, 0, 5],
    [0, 0, 0, 0, 8, 0, 0, 7, 9]
  ]
}
```

**レスポンス例（成功時）:**

```json
{
  "solution": [
    [5, 3, 4, 6, 7, 8, 9, 1, 2],
    [6, 7, 2, 1, 9, 5, 3, 4, 8],
    [1, 9, 8, 3, 4, 2, 5, 6, 7],
    [8, 5, 9, 7, 6, 1, 4, 2, 3],
    [4, 2, 6, 8, 5, 3, 7, 9, 1],
    [7, 1, 3, 9, 2, 4, 8, 5, 6],
    [9, 6, 1, 5, 3, 7, 2, 8, 4],
    [2, 8, 7, 4, 1, 9, 6, 3, 5],
    [3, 4, 5, 2, 8, 6, 1, 7, 9]
  ]
}
```

**エラーレスポンス例（無効なパズル）:**

```json
{
  "detail": "パズルが数独のルールに違反しています。"
}
```

**エラーレスポンス例（解答不能）:**

```json
{
  "detail": "解答が見つかりませんでした。このパズルは解けません。"
}
```

## 🚀 開発環境のセットアップ

このプロジェクトは [Poetry](https://python-poetry.org/) を使用して依存関係を管理しています。

### 前提条件

- Python 3.11以上
- Poetry

### 依存関係のインストール

```bash
cd backend
poetry install
```

### 開発サーバーの起動

```bash
poetry run uvicorn main:app --reload
```

デフォルトでは、APIは `http://127.0.0.1:8000` で利用可能になります。
Swagger UIドキュメントは `http://127.0.0.1:8000/docs` で確認できます。

## 🧪 テストの実行

```bash
poetry run pytest
```

## 📁 プロジェクト構造

```
backend/
├── main.py               # メインのアプリケーションコード
├── pyproject.toml        # Poetryプロジェクト設定
├── poetry.lock           # 依存関係ロックファイル
└── tests/
    └── test_api.py       # APIテストコード
```

## 🛠️ 技術スタック

- **フレームワーク**: [FastAPI](https://fastapi.tiangolo.com/) (v0.115.12)
- **サーバー**: [Uvicorn](https://www.uvicorn.org/) (v0.34.2)
- **パッケージ管理**: [Poetry](https://python-poetry.org/)
- **テスト**: [Pytest](https://pytest.org/) (v8.3.5)

## 📄 ライセンス

このプロジェクトは [MITライセンス](../LICENSE) の下で公開されています。
